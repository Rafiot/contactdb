{% macro render(form) -%}
<fieldset>
<script>
function clone_field_list(selector) {
    var new_element = $(selector).last().clone(true);
    var elem_num = new_element[0].childElementCount
    var elem_num = parseInt(elem_id.replace(/.*-(\d{1,4})/m, '$1')) + 1;
    new_element.find(':input').each(function() {
        var id = $(this).attr('id').replace('-' + (elem_num - 1) + '-', '-' + elem_num + '-');
        $(this).attr({'name': id, 'id': id}).val('').removeAttr('checked');
    });
    new_element.find('label').each(function() {
        var new_for = $(this).attr('for').replace('-' + (elem_num - 1) + '-', '-' + elem_num + '-');
        $(this).attr('for', new_for);
    });
    $(selector).after(new_element);
}
</script>
{% for field in form %}
  {% if field.type in ['CSRFTokenField', 'HiddenField'] %}
    {{ field() }}
  {% else %}
    <div class="clearfix {% if field.errors %}error{% endif %}">
      {{ field.label }}
      <div class="input">
        {% if field.name == "body" %}
          {{ field(rows=10, cols=40) }}
        {% else %}
          {% if field.type == 'FieldList' %}
          {{ field() }}
            <input type="button" value="Add More" id="add_more">
            <script>
              $(document).ready(function () {
              $('#add_more').click(function () {
                clone_field_list($("ul li"));
                  });
              });
            </script>
          {% else %}
            {{ field() }}
          {% endif %}
        {% endif %}
        {% if field.errors or field.help_text %}
          <span class="help-inline">
          {% if field.errors %}
            {{ field.errors|join(' ') }}
          {% else %}
            {{ field.help_text }}
          {% endif %}
          </span>
        {% endif %}
      </div>
    </div>
  {% endif %}
{% endfor %}
</fieldset>
{% endmacro %}

